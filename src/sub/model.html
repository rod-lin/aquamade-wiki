<html>
	<head>
		<script sync src="https://cdn.bootcss.com/mathjax/2.7.2/latest.js?config=TeX-AMS_HTML"></script>

		<script type="text/x-mathjax-config">
			MathJax.Ajax.config.path["mhchem"] = "https://cdn.bootcss.com/mathjax-mhchem/3.2.0";
			MathJax.Hub.Config({
				tex2jax: { inlineMath: [ [ "$", "$" ], [ "\\(", "\\)" ] ] },

				TeX: {
					extensions: [ "[mhchem]/mhchem.js" ]
				} 
			});
		</script>
	</head>

	<script>
		$(function () {
			menu.setItem("model");
		});
	</script>

	<link rel="stylesheet" type="text/css" href="/css/text.css">

	<script src="/js/comsec.js"></script>

	<div class="page-model comsec-main" style="font-family: Veneer;">
		<div class="main-block fullscr main-title" style="background-image: url('/img/cover4.jpg'); font-size: 7rem; text-align: center;">
			<div class="vcenter" style="line-height: 1; color: white;">
				<span>Modeling</span><br>
				<!-- <span class="blue">Integrated</span> -->
			</div>
		</div>
		
		<div class="line-sep"></div>
		
		<div class="block">
			<h1>Overview</h1>
			<div class="article article-font">
				In the modeling part, we basically made two models. One is for predicting time required for nitrite decomposition by our enzyme, which could be used when applying our product to the industrial production. The second model is the mechanism of our software.</p>
			</div>
		</div>
		
		<div class="line-sep"></div>
		
		<div class="block white-bg">
			<h1>Quick Menu</h1>
			<div class="quick-link passlink" data-passage="rods" style="background-image: url('/img/hp/foodadmin1.jpg');">Time Prediction</div>
			<div class="quick-link passlink" data-passage="daniels" style="background-image: url('/img/hp/zjuint1.jpg');">Software</div>
		</div>
		
		<style>
		
			.float-menu {
				position: absolute;
				left: 0;
				width: 17rem !important;
			}
			
			.article-cont {
				padding-left: 19rem;
			}
			
			.passage {
				display: none;
			}
			
			.passage.shown {
				display: block;
			}
			
		</style>

		<div class="line-sep"></div>
		
		<div class="block main-cont-block white-bg">
			<div class="wide article article-font">
				<!-- <div class="ui vertical menu float-menu">
					<div class="item">
						<div class="header">Interview with Food Administration</div>
						<div class="menu">
							<a class="item">Enterprise</a>
							<a class="item">Consumer</a>
						</div>
					</div>
				</div> -->
				<div style="position: absolute; left: 0; top: 0;">
					<div class="ui secondary vertical menu float-menu sticky">
						<a class="active item passlink" data-passage="rods">Time Prediction</a>
						<a class="item passlink" data-passage="daniels">Software</a>
					</div>
				</div>

				<div class="atext article-cont">
					<div class="passage passage-rods shown">
						<h1>A Model for Predicting Time Required to Decompose Nitrite</h1>

						<h2>1 Abstract</h2>
						As stated in the project breif, our ultimate goal is to reduce the time needed for $\ce{NO2-}$ to decompose. Therefore, the prediction of the time needed to reduce $\ce{NO2-}$ to a healthy level is a crucial part to apply our project to industrial production. We built three models for each of our enzymes based on enzyme kinetics to reach our final target.
						<br>

						<h2>2 Model</h2>
						<h3>2.1 Variables</h3>
						We use the following symbols to represent the variables included in our model.<br><br>
						
						<table class="frameless">
							<thead></thead>

							</tbody>
								<tr>
										<td style="width: 5em;">$C_s$</td>
										<td>Concentration of substrate($\ce{NO2–}$ in this case)</td>
								</tr>
								
								<tr>
										<td>$C_p$</td>
										<td>Concentration of productCeConcentration of enzyme</td>
								</tr>
								
								<tr>
										<td>$V_{max}$</td>
										<td>Maximum rate of reaction</td>
								</tr>

								<tr>
										<td>$K_m$</td>
										<td>Michaelis-Menten constant</td>
								</tr>

								<tr>
										<td>$K_c$</td>
										<td>A trivial constant in a solution for the diﬀerential equation</td>
								</tr>

								<tr>
										<td>$K_{cat}$</td>
										<td>Turnover number</td>
								</tr>

								<tr>
										<td>$c_n$</td>
										<td>Trivial constant</td>
								</tr>
							</tbody>
						</table>
						<br>

						<h3>2.2 Model for the Relation between ∆t and Cs</h3>
						The rate of reaction of a enzymatic reaction can be modelled by the well-known Michaelis-Mentenequation, which is stated as
					
						$$ v = \frac{dC_p}{dt} = - \frac{dC_s}{dt} = \frac{V_{max} C_s}{K_m + C_s} $$

						What we need to get to reach our goal is to find a function of $ C_s = f(t) $, so that we can predict the time spent, $ \Delta t $, by substituting the initial concentration $ C_{0} $ and the target concentration $ C_{t} $ to get the time difference.
						<br><br>
						Therefore, by separating the variables in two sides of the equation and integrating both sides, we can get one solution set to this diﬀerential equation.

						$$ - \frac{dC_s}{dt} = \frac{V_{max} C_s}{K_m + C_s} $$
						$$ - \frac{K_m + C_s}{V_{max} C_s} dC_s = dt $$
						$$ - \int \frac{K_m + C_s}{V_{max} C_s} dC_s = \int dt $$
						$$ - \int \frac{K_m}{V_{max}} \frac{1}{C_s} + \frac{1}{V_{max}} dC_s = t + c_1 $$
						$$ - \frac{K_m}{V_{max}} ln(C_s) - \frac{1}{V_{max}} C_s + c_2 = t + c_1 $$
						$$ - \frac{K_m}{V_{max}} ln(C_s) - \frac{1}{V_{max}} C_s + (c_2 - c_1) = t $$

						Let $ K_{c} = c_2 - c_1 $, we get our final solution

						$$ t = - \frac{K_m}{V_{max}} ln(C_s) - \frac{1}{V_{max}} C_s + K_{c} $$

						Where $ K_m $ and $ V_{max} $ can be found through our experiments stated below.
						<br><br>
						So to use the model, we simply need to substitute $ C_s = C_0 $, $ t = 0 $ to the solution, and get
						
						$$ K_c = \frac{K_m}{V_{max}} ln(C_0) + \frac{1}{V_{max}} C_0 $$

						And substitute $ K_c $ back, we get
						
						$$ \Delta t = t - 0 = \frac{K_m}{V_{max}} (ln(C_0) - ln(C_s)) + \frac{1}{V_{max}} (C_0 - C_s) $$
						$$ \Delta t = \frac{K_m}{V_{max}} (ln(C_0 / C_s)) + \frac{1}{V_{max}} (C_0 - C_s) $$
						And $ C_s $ is our target concentration of substrate($\ce{NO2-}$).

						<br><br>
						Because $ V_{max} $ and enzyme concentration $ C_e $ are related by the turnover number $ K_{cat} $
						
						$$ V_{max} = K_{cat} C_e $$

						We can rewrite the equation as
						
						$$ \Delta t = \frac{K_m}{K_{cat} C_e} (ln(C_0 / C_s)) + \frac{1}{K_{cat} C_e} (C_0 - C_s) $$
						$$ \Delta t = \frac{K_m (ln(C_0 / C_s)) + (C_0 - C_s)}{K_{cat} C_e} $$
						<br>

						<h3>2.3 Determine the Parameters</h3>

						The last step completing this model is to determine $ K_m $ and $ V_{max} $ in this model. We used the Lineweaver-Burk plot to find the two constants.
						<br><br>
						By taking the reciprocals of two sides the Michaelis-Menten equation, we can get a linear relation between $ \frac{1}{v} $ and $ \frac{1}{C_s} $, which then can be used to determine the parameters $ K_m $ and $ V_{max} $.
						
						$$ - \frac{1}{\frac{dC_s}{dt}} = \frac{K_m + C_s}{V_{max} C_s} $$
						$$ - \frac{1}{\frac{dC_s}{dt}} = \frac{K_m}{V_{max}} \frac{1}{C_s} + \frac{1}{V_{max}} $$

						So by linear regression of our experiment data($ - \frac{1}{\frac{dC_s}{dt}} $ against $ \frac{1}{C_s} $), we computed the parameters(Figure 2.3.1).

						<img class="figure img" src="/img/model/fig1.png"></img>
						
						The regression results are
						<br>

						<table class="frameless">
							<thead></thead>

							</tbody>
								<tr>
										<td style="width: 5em;">$K_m$</td>
										<td>0.95489 $ mmol\ dm^{-3} $</td>
								</tr>
								
								<tr>
										<td>$V_{max}$</td>
										<td>1.1637e-05 $ mmol\ dm^{-3}\ s^{-1} $</td>
								</tr>
							</tbody>
						</table>

						<br>

						Substituting back the parameters, we get the $ C_s $-$ t $ graph(the dots are our data from the experiments)

						<img class="figure img" src="/img/model/fig2.png"></img>

						<h3>2.4 Model simulation in MATLAB</h3>

						<pre class="code-block">
%%%%%%%%%%%%% data %%%%%%%%%%%%%

% absorbance
A = [ 0.408 0.393 0.367 0.302 0.276 0.201 0.155 0.155 0.104 ];
t = [ 3 5.5 7.5 20.5 22.5 25 28 31 46.5 ]; % in hours

% parameters of the standard curve(absorbance against concentration of NaNO2 in mg/L)
std_k = 0.647659;
std_b = 0.00872129;

%%%%%%%%%%%%% model %%%%%%%%%%%%%

% convert hr to sec
t = t .* (60 * 60);

% times 100 because solution is diluted
C = (A .- std_b) ./ std_k ./ (23 + 14 + 32) .* 100;
C0 = C(1);

v = -gradient(C) ./ gradient(t);
ln = @(x) log(x) ./ log(e);

poly = polyfit(1 ./ C, 1 ./ v, 1);

km = poly(1) / poly(2) % in mmol/L
vmax = 1 / poly(2) % in mmol/L/s

% model equation
m1 = @(cs) (km .* (ln(C0 ./ cs)) .+ (C0 .- cs)) ./ vmax;

plot(t, C, '.k'); hold;
plot(m1(linspace(0, C0, 100)), linspace(0, C0, 100), 'k');

ylabel('Cs');
xlabel('t/s');
						</pre>
						
						<br>

						<h3>2.5 Further Improvement</h3>
						Although we can get the basic relation between concentration of $\ce{NO2-}$ and time, there are still some factors we haven't considered. Firstly, the relation between enzyme concentration and cell concentration is still not clear. So in a real situation, where the bacteria are put into the pickle mixutre, the increase in the concentration of our enzyme is not included in our model. We hope that our future improvement of the model will allow us to more effectively predict the time required in a real production situation.
						<br><br>

						<h2>3 Reference</h2>
						<table class="frameless ref-table">
							<tbody>
								<tr>
									<td><div class="no noind">1</div></td>
									<td>J K Kristjansson and T C Hollocher, "First practical assay for soluble nitrous oxide reductase of denitrifying bacteria and a partial kinetic characterization". J. Biol. Chem. 1980, 255:704-707.</td>
								</tr>

								<tr>
									<td><div class="no noind">2</div></td>
									<td>Lineweaver, H; Burk, D. (1934). "The determination of enzyme dissociation constants". Journal of the American Chemical Society. 56 (3): 658–666. doi:10.1021/ja01318a036.</td>
								</tr>

								<tr>
									<td><div class="no noind">3</div></td>
									<td>Michaelis, L.; Menten, M.L. (1913). "Die Kinetik der Invertinwirkung". Biochem Z. 49: 333–369 (recent translation, and an older partial translation)</td>
								</tr>
							</tbody>
						</table>

						<p></p>
					</div>

					<div class="passage passage-daniels">
						<h1>Software</h1>

						When we talk about processing the data, basically, it means to study the pattern behind existing datasets. One common practice is to use statistic method to display the datasets on a table, and then form a curve across all valid data. If the curve perfectly cuts through the dataset, it is referred to as best-fit. The significance behind best-fit line is to reveal the relationship between independent variable and dependent variable, which makes a great contribution to people’s life. 
						<br><br>

						The first step to perform a regression is to form a feature space. Dimensions of a feature space depends on the scale of your dataset. For example, if you have twenty-six groups of data, you form a twenty-six dimensional feature space. Traditionally, biologists modify the best-fit line by narrowing down the variance, which is a typical kind of linear regression. 
						<br><br>

						Today, with the advent of AI, biologists have more choices of data processing. One of the popular models is neural networks based on back propagation, and the other one is machine learning based logistic regression. From a high school IGEM participant’s scope, team HFLS_H2Z will show you the difference between these models and the scope of their abilities.
						<br><br>

						<h2>Neural networks VS Linear regression</h2>
						
						Judging from the outcome, the difference between linear regression and the neural network based on back propagation is their accuracy of estimates. 
						
						<img class="framed img" src="/img/software/model1.jpg"></img>

						<img class="framed img" src="/img/software/model2.jpg"></img>

						Clearly, we can see that neural network perform better than linear regression on fitting. The secret behind neural network’s accuracy is attributed to back propagation, the mechanism constantly modify the net.

						<img class="framed img" src="/img/software/model3.jpg"></img>

						Neural networks consist of neurons, and we divide neurons into three layers: the first one is input layer, the second one is hidden layer, and the third one is output layer.

						<img class="framed img" src="/img/software/model4.jpg"></img>

						To build a net, we set initial values to each weight. Based on linear regression equation, we perform a forward propagation. Take input1 as an example,

						$$ net_{h1} = w_1 \times i_1 + w_2 \times i_2 + b_1 \times 1 $$
						$$ net_{h1} = 0.15 \times 0.05 + 0.2 \times 0.1 + 0.35 \times 1 = 0.3775 $$

						Clearly, we can see there is a huge difference between calculated output1 (0.593269992) and actual value (0.01). At this point, we need to perform a back propagation to modify each weight.

						<img class="framed img" src="/img/software/model5.jpg"></img>

						First, we calculate the square error.

						$$ E_{total} = \sum \frac{1}{2} (\mbox{target} - \mbox{output})^2 = E_1 + E_2 = 0.274811083 + 0.023560026 = 0.298371109 $$

						We hope we can find out how each weight influence the outcome. Take w5 as an example, we use chain rule to figure out its partial derivative, which reflects how influence the total square error.

						$$ \frac{\delta E_{total}}{\delta w_5} = \frac{\delta E_{total}}{\delta \mbox{out}_{o1}} \times \frac{\delta \mbox{out}_{o1}}{\delta \mbox{net}_{o1}} \times \frac{\delta \mbox{net}_{o1}}{\delta w_5} = 0.74136507 \times 0.186815602 \times 0.593269992 = 0.082167041 $$

						And it enables us to update the value of $ w_5 $. $ \eta $ represents the study rate of the net.

						$$ w_{5_new} = w_5 - \eta \times \frac{\delta E_{total}}{\delta w_5} = 0.4 - 0.5 \times 0.082167041 = 0.3591648 $$

						The back propagation constantly modifies the value of each weight. It ensures that the eventual net will be the best-fit one for the dataset. And this is why it performs better than linear regression. On the contrast, linear regression is more about forward propagation.
						<br><br>

						But it does not mean that neural network definitely performs better than linear regression. First, it costs time to train a net. Second, the net requires large datasets. Third, it is difficult for high school beginners to create their own net. But we can say for certain that neural networks are strong tools to study the pattern behind data.

						<h2>Logistic regression VS Linear regression</h2>

						Logistic regression is appropriate for cases that data are binary dependent variables. For example, the output can take only two values, "0" and "1", which represent outcomes such as pass/fail, win/lose, alive/dead or healthy/sick. In comparison to linear regression, logistic regression is not sensitive to XXX. For example, according to the size of a tumor, doctors judge whether the tumor is malignant. The table 1.a and 1.b use linear regression.

						<img class="framed img" src="/img/software/model6.jpg"></img>
						(Picture by Andrew Ng)

						<table class="frameless ref-table">
							<tbody>
								<tr>
									<td><div class="no noind">1</div></td>
									<td>Zhang S, Zhang L, Qiu K, et al. Variable Selection in Logistic Regression Model[J]. Chinese Journal of Electronics, 2015, 24(4):813-817.</td>
								</tr>
		
								<tr>
									<td><div class="no noind">2</div></td>
									<td>Marla, Maniquiz, Soyoung, et al. Multiple linear regression models of urban runoff pollutant load and event mean concentration considering rainfall variables[J]. 环境科学学报(英文版), 2010, 22(6):946.</td>
								</tr>
		
								<tr>
									<td><div class="no noind">3</div></td>
									<td>Ng A. Efficient L1 Regularized Logistic Regression[J]. In AAAI-06, 2006, 1:1--9.</td>
								</tr>
							</tbody>
						</table>

						<p></p>
					</div>
				</div>
			</div>
		</div>
	</div>
</html>
